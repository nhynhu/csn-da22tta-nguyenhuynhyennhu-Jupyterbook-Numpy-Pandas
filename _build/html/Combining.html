
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kết Hợp và Ghép Nối Các Tập Dữ Liệu &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Combining';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Định Hình Lại và Pivoting" href="Reshaping.html" />
    <link rel="prev" title="Đánh Chỉ Mục Phân Cấp" href="Indexing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tongquan.html">Tổng quan về NumPy và Pandas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Numpy.html">NumPy Cơ Bản Mảng và Tính Toán Vector</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="ndarray.html">Đối tượng ndarray Mảng Nhiều Chiều</a></li>
<li class="toctree-l2"><a class="reference internal" href="Arithmetic.html">Các Phép Toán trên Mảng</a></li>
<li class="toctree-l2"><a class="reference internal" href="UniversalFunctions.html">Hàm Toàn Cục: Các Hàm Mảng Nhanh Theo Phần Tử</a></li>


<li class="toctree-l2"><a class="reference internal" href="InputOutput.html">Nhập/Xuất Dữ Liệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="Khac.html">Đại Số Tuyến Tính với NumPy</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Pandas.html">Pandas cơ bản</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="DataStructures.html">Giới Thiệu Cấu Trúc Dữ Liệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="EssentialFunctionality.html">Các Chức Năng Cơ Bản</a></li>
<li class="toctree-l2"><a class="reference internal" href="DescriptiveStatistics.html">Thống Kê và Phân Tích Dữ Liệu</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Format.html">Nạp, Lưu Trữ và Định Dạng Dữ Liệu</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="TextFormat.html">Đọc và Ghi Dữ Liệu Văn Bản</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataFormat.html">Định Dạng Dữ Liệu Nhị Phân</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="DataCleaning.html">Làm Sạch và Chuẩn Bị Dữ Liệu</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Handling.html">Xử Lý Dữ Liệu Thiếu</a></li>
<li class="toctree-l2"><a class="reference internal" href="Transformation.html">Biến Đổi Dữ Liệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="StringManipulation.html">Xử Lý Chuỗi Ký Tự</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="DataWrangling.html">Biến Đổi và Kết Hợp Dữ Liệu</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Indexing.html">Indexing Phân Cấp</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Kết Hợp Dữ Liệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reshaping.html">Biến Đổi Dữ Liệu</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="BTNumpy.html">Bài tập Numpy cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="BTPandas.html">Cài đặt và tải dữ liệu</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FCombining.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Combining.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Kết Hợp và Ghép Nối Các Tập Dữ Liệu</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-dataframe-theo-kieu-co-so-du-lieu">Ghép Nối DataFrame Theo Kiểu Cơ Sở Dữ Liệu</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-1-cac-loai-ghep-noi-khac-nhau-voi-doi-so-how">Bảng 6-1. Các loại ghép nối khác nhau với đối số <code class="docutils literal notranslate"><span class="pre">how</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-nhieu-den-nhieu">Ghép Nối Nhiều-Đến-Nhiều</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-2-cac-tham-so-ham-merge">Bảng 6-2. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-tren-chi-muc">Ghép Nối Trên Chỉ Mục</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-doc-theo-mot-truc">Ghép Nối Dọc Theo Một Trục</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-3-cac-tham-so-ham-concat">Bảng 6-3. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">concat</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-du-lieu-voi-su-chong-lan">Kết Hợp Dữ Liệu Với Sự Chồng Lấn</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ket-hop-va-ghep-noi-cac-tap-du-lieu">
<h1>Kết Hợp và Ghép Nối Các Tập Dữ Liệu<a class="headerlink" href="#ket-hop-va-ghep-noi-cac-tap-du-lieu" title="Link to this heading">#</a></h1>
<p>Dữ liệu chứa trong các đối tượng pandas có thể được kết hợp theo nhiều cách khác nhau:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas.merge</span></code> kết nối các hàng trong DataFrame dựa trên một hoặc nhiều khóa. Điều này sẽ quen thuộc với những người dùng SQL hoặc các cơ sở dữ liệu quan hệ khác, vì nó thực hiện các thao tác nối cơ sở dữ liệu.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code> nối hoặc “xếp chồng” các đối tượng cùng một trục.</p></li>
<li><p>Phương thức <code class="docutils literal notranslate"><span class="pre">combine_first</span></code> cho phép ghép nối dữ liệu chồng chéo để điền vào các giá trị thiếu trong một đối tượng bằng các giá trị từ một đối tượng khác.</p></li>
</ul>
<section id="ghep-noi-dataframe-theo-kieu-co-so-du-lieu">
<h2>Ghép Nối DataFrame Theo Kiểu Cơ Sở Dữ Liệu<a class="headerlink" href="#ghep-noi-dataframe-theo-kieu-co-so-du-lieu" title="Link to this heading">#</a></h2>
<p>Các thao tác ghép nối hoặc nối dữ liệu kết hợp các tập dữ liệu bằng cách liên kết các hàng sử dụng một hoặc nhiều khóa. Các thao tác này là trung tâm của các cơ sở dữ liệu quan hệ (ví dụ, dựa trên SQL). Hàm <code class="docutils literal notranslate"><span class="pre">merge</span></code> trong pandas là điểm nhập chính để sử dụng các thuật toán này trên dữ liệu của bạn. Hãy bắt đầu với một ví dụ đơn giản:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)})</span>
<span class="n">df1</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">a</span>
<span class="mi">3</span>      <span class="mi">3</span>   <span class="n">c</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>
<span class="mi">6</span>      <span class="mi">6</span>   <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data2</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">a</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">d</span>
</pre></div>
</div>
<p>Đây là một ví dụ về ghép nối nhiều-đến-một; dữ liệu trong df1 có nhiều hàng được gán nhãn a và b, trong khi df2 chỉ có một hàng cho mỗi giá trị trong cột khóa. Gọi merge với các đối tượng này, chúng ta thu được:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>      <span class="mi">6</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">3</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>      <span class="mi">0</span>
</pre></div>
</div>
<p>Lưu ý rằng không chỉ định cột nào để nối. Nếu thông tin đó không được chỉ định, merge sử dụng các tên cột trùng lặp làm khóa. Tốt hơn là chỉ định rõ ràng:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>      <span class="mi">6</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">3</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>      <span class="mi">0</span>
</pre></div>
</div>
<p>Nếu các tên cột khác nhau trong từng đối tượng, có thể chỉ định chúng riêng biệt:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;lkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;rkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lkey&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;rkey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">lkey</span>  <span class="n">data2</span> <span class="n">rkey</span>
<span class="mi">0</span>      <span class="mi">0</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">1</span>      <span class="mi">1</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">6</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">3</span>      <span class="mi">2</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>
<span class="mi">4</span>      <span class="mi">4</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>
<span class="mi">5</span>      <span class="mi">5</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>
</pre></div>
</div>
<p>Bạn có thể nhận thấy rằng các giá trị ‘c’ và ‘d’ và dữ liệu liên quan bị thiếu trong kết quả. Mặc định merge thực hiện một ghép nối ‘inner’; các khóa trong kết quả là giao, hoặc tập hợp chung được tìm thấy trong cả hai bảng. Các tùy chọn khác có thể là ‘left’, ‘right’ và ‘outer’. Ghép nối ‘outer’ lấy hợp của các khóa, kết hợp hiệu ứng của việc áp dụng cả hai ghép nối trái và phải:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>    <span class="mf">0.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="mf">1.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">6.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">3</span>    <span class="mf">2.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">4</span>    <span class="mf">4.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">5</span>    <span class="mf">5.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">6</span>    <span class="mf">3.0</span>   <span class="n">c</span>    <span class="n">NaN</span>
<span class="mi">7</span>    <span class="n">NaN</span>   <span class="n">d</span>    <span class="mf">2.0</span>
</pre></div>
</div>
</section>
<section id="bang-6-1-cac-loai-ghep-noi-khac-nhau-voi-doi-so-how">
<h2>Bảng 6-1. Các loại ghép nối khác nhau với đối số <code class="docutils literal notranslate"><span class="pre">how</span></code><a class="headerlink" href="#bang-6-1-cac-loai-ghep-noi-khac-nhau-voi-doi-so-how" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tùy chọn</p></th>
<th class="head"><p>Hành vi</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inner</span></code></p></td>
<td><p>Sử dụng chỉ các kết hợp khóa quan sát được trong cả hai bảng.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">left</span></code></p></td>
<td><p>Sử dụng tất cả các kết hợp khóa tìm thấy trong bảng trái.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">right</span></code></p></td>
<td><p>Sử dụng tất cả các kết hợp khóa tìm thấy trong bảng phải.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">outer</span></code></p></td>
<td><p>Sử dụng tất cả các kết hợp khóa quan sát được trong cả hai bảng cùng nhau.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ghep-noi-nhieu-den-nhieu">
<h2>Ghép Nối Nhiều-Đến-Nhiều<a class="headerlink" href="#ghep-noi-nhieu-den-nhieu" title="Link to this heading">#</a></h2>
<p>Các ghép nối nhiều-đến-nhiều có hành vi được xác định rõ ràng, mặc dù không nhất thiết phải trực quan. Dưới đây là một ví dụ:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)})</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">a</span>
<span class="mi">3</span>      <span class="mi">3</span>   <span class="n">c</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data2</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">a</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">a</span>
<span class="mi">3</span>      <span class="mi">3</span>   <span class="n">b</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">d</span>
</pre></div>
</div>
<p>Ghép nối nhiều-đến-nhiều tạo ra tích Descartes của các hàng. Vì có ba hàng ‘b’ trong DataFrame bên trái và hai trong DataFrame bên phải, nên có sáu hàng ‘b’ trong kết quả. Phương thức nối chỉ ảnh hưởng đến các giá trị khóa khác nhau xuất hiện trong kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">1</span>      <span class="mi">0</span>   <span class="n">b</span>    <span class="mf">3.0</span>
<span class="mi">2</span>      <span class="mi">1</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">3</span>      <span class="mi">1</span>   <span class="n">b</span>    <span class="mf">3.0</span>
<span class="mi">4</span>      <span class="mi">2</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">5</span>      <span class="mi">2</span>   <span class="n">a</span>    <span class="mf">2.0</span>
<span class="mi">6</span>      <span class="mi">3</span>   <span class="n">c</span>    <span class="n">NaN</span>
<span class="mi">7</span>      <span class="mi">4</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">8</span>      <span class="mi">4</span>   <span class="n">a</span>    <span class="mf">2.0</span>
<span class="mi">9</span>      <span class="mi">5</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">10</span>     <span class="mi">5</span>   <span class="n">b</span>    <span class="mf">3.0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">1</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">3</span>
<span class="mi">2</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">3</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">3</span>
<span class="mi">4</span>      <span class="mi">5</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">b</span>      <span class="mi">3</span>
<span class="mi">6</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">7</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>
<span class="mi">8</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">9</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">2</span>
</pre></div>
</div>
<p>Để ghép nối với nhiều khóa, hãy truyền một danh sách các tên cột:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span> <span class="s1">&#39;lval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span> <span class="s1">&#39;rval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2</span>  <span class="n">lval</span>  <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>  <span class="n">one</span>   <span class="mf">1.0</span>   <span class="mf">4.0</span>
<span class="mi">1</span>  <span class="n">foo</span>  <span class="n">one</span>   <span class="mf">1.0</span>   <span class="mf">5.0</span>
<span class="mi">2</span>  <span class="n">foo</span>  <span class="n">two</span>   <span class="mf">2.0</span>   <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">bar</span>  <span class="n">one</span>   <span class="mf">3.0</span>   <span class="mf">6.0</span>
<span class="mi">4</span>  <span class="n">bar</span>  <span class="n">two</span>   <span class="n">NaN</span>   <span class="mf">7.0</span>
</pre></div>
</div>
<p>Khi ghép nối các cột với các cột, các chỉ mục trên các đối tượng DataFrame được truyền vào sẽ bị loại bỏ.</p>
<p>Một vấn đề cuối cùng cần xem xét trong các thao tác ghép nối là việc xử lý các tên cột trùng lặp. Trong khi bạn có thể giải quyết sự trùng lặp thủ công (xem phần trước về đổi tên nhãn trục), hàm merge có tùy chọn suffixes để chỉ định các chuỗi để thêm vào các tên trùng lặp trong các đối tượng DataFrame bên trái và bên phải:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2_x</span>  <span class="n">lval</span> <span class="n">key2_y</span>  <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>    <span class="n">one</span>     <span class="mi">1</span>    <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">1</span>  <span class="n">foo</span>    <span class="n">one</span>     <span class="mi">1</span>    <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">2</span>  <span class="n">foo</span>    <span class="n">two</span>     <span class="mi">2</span>    <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">3</span>  <span class="n">foo</span>    <span class="n">two</span>     <span class="mi">2</span>    <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">4</span>  <span class="n">bar</span>    <span class="n">one</span>     <span class="mi">3</span>    <span class="n">one</span>     <span class="mi">6</span>
<span class="mi">5</span>  <span class="n">bar</span>    <span class="n">one</span>     <span class="mi">3</span>    <span class="n">two</span>     <span class="mi">7</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key1</span> <span class="n">key2_left</span>  <span class="n">lval</span> <span class="n">key2_right</span>  <span class="n">rval</span>
<span class="mi">0</span>  <span class="n">foo</span>       <span class="n">one</span>     <span class="mi">1</span>        <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">1</span>  <span class="n">foo</span>       <span class="n">one</span>     <span class="mi">1</span>        <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">2</span>  <span class="n">foo</span>       <span class="n">two</span>     <span class="mi">2</span>        <span class="n">one</span>     <span class="mi">4</span>
<span class="mi">3</span>  <span class="n">foo</span>       <span class="n">two</span>     <span class="mi">2</span>        <span class="n">one</span>     <span class="mi">5</span>
<span class="mi">4</span>  <span class="n">bar</span>       <span class="n">one</span>     <span class="mi">3</span>        <span class="n">one</span>     <span class="mi">6</span>
<span class="mi">5</span>  <span class="n">bar</span>       <span class="n">one</span>     <span class="mi">3</span>        <span class="n">two</span>     <span class="mi">7</span>
</pre></div>
</div>
</section>
<section id="bang-6-2-cac-tham-so-ham-merge">
<h2>Bảng 6-2. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#bang-6-2-cac-tham-so-ham-merge" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tham số</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left</span></code></p></td>
<td><p>DataFrame được ghép nối ở phía trái.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right</span></code></p></td>
<td><p>DataFrame được ghép nối ở phía phải.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p></td>
<td><p>Một trong các giá trị ‘inner’, ‘outer’, ‘left’, hoặc ‘right’; mặc định là ‘inner’.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></td>
<td><p>Tên các cột để ghép nối. Phải được tìm thấy trong cả hai đối tượng DataFrame. Nếu không chỉ định và không có khóa nối khác, sẽ sử dụng giao của tên các cột trong <code class="docutils literal notranslate"><span class="pre">left</span></code> và <code class="docutils literal notranslate"><span class="pre">right</span></code> làm khóa nối.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code></p></td>
<td><p>Các cột trong DataFrame bên trái để sử dụng làm khóa nối.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right_on</span></code></p></td>
<td><p>Tương tự như <code class="docutils literal notranslate"><span class="pre">left_on</span></code> cho DataFrame bên phải.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left_index</span></code></p></td>
<td><p>Sử dụng chỉ mục hàng trong <code class="docutils literal notranslate"><span class="pre">left</span></code> làm khóa nối của nó (hoặc các khóa, nếu là một <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">right_index</span></code></p></td>
<td><p>Tương tự như <code class="docutils literal notranslate"><span class="pre">left_index</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sort</span></code></p></td>
<td><p>Sắp xếp dữ liệu đã ghép nối theo thứ tự từ điển học bằng các khóa nối; True theo mặc định (vô hiệu hóa để có hiệu suất tốt hơn trong một số trường hợp trên các tập dữ liệu lớn).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">suffixes</span></code></p></td>
<td><p>Tuple các giá trị chuỗi để thêm vào tên cột trong trường hợp trùng lặp; mặc định là (‘_x’, ‘_y’) (ví dụ, nếu ‘data’ trong cả hai đối tượng DataFrame, sẽ xuất hiện dưới dạng ‘data_x’ và ‘data_y’ trong kết quả).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">copy</span></code></p></td>
<td><p>Nếu False, tránh sao chép dữ liệu vào cấu trúc dữ liệu kết quả trong một số trường hợp ngoại lệ; mặc định luôn sao chép.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">indicator</span></code></p></td>
<td><p>Thêm một cột đặc biệt <code class="docutils literal notranslate"><span class="pre">_merge</span></code> chỉ ra nguồn của mỗi hàng; các giá trị sẽ là ‘left_only’, ‘right_only’, hoặc ‘both’ dựa trên nguồn gốc của dữ liệu đã ghép nối trong mỗi hàng.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ghep-noi-tren-chi-muc">
<h2>Ghép Nối Trên Chỉ Mục<a class="headerlink" href="#ghep-noi-tren-chi-muc" title="Link to this heading">#</a></h2>
<p>Trong một số trường hợp, khóa ghép nối trong một DataFrame sẽ nằm trong chỉ mục của nó. Trong trường hợp này, bạn có thể truyền <code class="docutils literal notranslate"><span class="pre">left_index=True</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">right_index=True</span></code> (hoặc cả hai) để chỉ ra rằng chỉ mục nên được sử dụng làm khóa ghép nối:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">right1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;group_val&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left1</span><span class="p">,</span> <span class="n">right1</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>  <span class="n">group_val</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>        <span class="mf">3.5</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>        <span class="mf">3.5</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>        <span class="mf">3.5</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>        <span class="mf">7.0</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>        <span class="mf">7.0</span>
</pre></div>
</div>
<p>Vì phương thức ghép nối mặc định là giao của các khóa nối, bạn có thể thay vào đó tạo hợp của chúng với một ghép nối ngoài:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left1</span><span class="p">,</span> <span class="n">right1</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>  <span class="n">group_val</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>        <span class="mf">3.5</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>        <span class="mf">3.5</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>        <span class="mf">3.5</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>        <span class="mf">7.0</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>        <span class="mf">7.0</span>
<span class="mi">5</span>   <span class="n">c</span>      <span class="mi">5</span>        <span class="n">NaN</span>
</pre></div>
</div>
<p>Với dữ liệu được đánh chỉ mục phân cấp, mọi thứ phức tạp hơn, vì ghép nối trên chỉ mục ngầm định là một ghép nối nhiều khóa:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lefth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">],</span>
                      <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)})</span>
<span class="n">righth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                      <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">],</span>
                             <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">]],</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;event1&#39;</span><span class="p">,</span> <span class="s1">&#39;event2&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lefth</span><span class="p">,</span> <span class="n">righth</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">],</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data</span>    <span class="n">key1</span>  <span class="n">key2</span>  <span class="n">event1</span>  <span class="n">event2</span>
<span class="mi">0</span>   <span class="mf">0.0</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>     <span class="mf">4.0</span>     <span class="mf">5.0</span>
<span class="mi">0</span>   <span class="mf">0.0</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>     <span class="mf">6.0</span>     <span class="mf">7.0</span>
<span class="mi">1</span>   <span class="mf">1.0</span>    <span class="n">Ohio</span>  <span class="mi">2001</span>     <span class="mf">8.0</span>     <span class="mf">9.0</span>
<span class="mi">2</span>   <span class="mf">2.0</span>    <span class="n">Ohio</span>  <span class="mi">2002</span>    <span class="mf">10.0</span>    <span class="mf">11.0</span>
<span class="mi">3</span>   <span class="mf">3.0</span>  <span class="n">Nevada</span>  <span class="mi">2001</span>     <span class="mf">0.0</span>     <span class="mf">1.0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lefth</span><span class="p">,</span> <span class="n">righth</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">],</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">data</span>    <span class="n">key1</span>  <span class="n">key2</span>  <span class="n">event1</span>  <span class="n">event2</span>
<span class="mi">0</span>   <span class="mf">0.0</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>     <span class="mf">4.0</span>     <span class="mf">5.0</span>
<span class="mi">0</span>   <span class="mf">0.0</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>     <span class="mf">6.0</span>     <span class="mf">7.0</span>
<span class="mi">1</span>   <span class="mf">1.0</span>    <span class="n">Ohio</span>  <span class="mi">2001</span>     <span class="mf">8.0</span>     <span class="mf">9.0</span>
<span class="mi">2</span>   <span class="mf">2.0</span>    <span class="n">Ohio</span>  <span class="mi">2002</span>    <span class="mf">10.0</span>    <span class="mf">11.0</span>
<span class="mi">3</span>   <span class="mf">3.0</span>  <span class="n">Nevada</span>  <span class="mi">2001</span>     <span class="mf">0.0</span>     <span class="mf">1.0</span>
<span class="mi">4</span>   <span class="mf">4.0</span>  <span class="n">Nevada</span>  <span class="mi">2002</span>     <span class="n">NaN</span>     <span class="n">NaN</span>
<span class="mi">4</span>   <span class="n">NaN</span>  <span class="n">Nevada</span>  <span class="mi">2000</span>     <span class="mf">2.0</span>     <span class="mf">3.0</span>
</pre></div>
</div>
<p>Sử dụng chỉ mục của cả hai phía của ghép nối cũng có thể thực hiện được:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">])</span>
<span class="n">right2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Missouri&#39;</span><span class="p">,</span> <span class="s1">&#39;Alabama&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left2</span><span class="p">,</span> <span class="n">right2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">Ohio</span>  <span class="n">Nevada</span>  <span class="n">Missouri</span>  <span class="n">Alabama</span>
<span class="n">a</span>   <span class="mf">1.0</span>     <span class="mf">2.0</span>       <span class="n">NaN</span>      <span class="n">NaN</span>
<span class="n">b</span>   <span class="n">NaN</span>     <span class="n">NaN</span>       <span class="mf">7.0</span>      <span class="mf">8.0</span>
<span class="n">c</span>   <span class="mf">3.0</span>     <span class="mf">4.0</span>       <span class="mf">9.0</span>     <span class="mf">10.0</span>
<span class="n">d</span>   <span class="n">NaN</span>     <span class="n">NaN</span>      <span class="mf">11.0</span>     <span class="mf">12.0</span>
<span class="n">e</span>   <span class="mf">5.0</span>     <span class="mf">6.0</span>      <span class="mf">13.0</span>     <span class="mf">14.0</span>
</pre></div>
</div>
<p>DataFrame có một phương thức join tiện lợi để ghép nối theo chỉ mục. Nó cũng có thể được sử dụng để kết hợp nhiều đối tượng DataFrame có cùng hoặc tương tự chỉ mục nhưng các cột không trùng lặp. Trong ví dụ trước, chúng ta có thể viết:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left2</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">Ohio</span>  <span class="n">Nevada</span>  <span class="n">Missouri</span>  <span class="n">Alabama</span>
<span class="n">a</span>   <span class="mf">1.0</span>     <span class="mf">2.0</span>       <span class="n">NaN</span>      <span class="n">NaN</span>
<span class="n">b</span>   <span class="n">NaN</span>     <span class="n">NaN</span>       <span class="mf">7.0</span>      <span class="mf">8.0</span>
<span class="n">c</span>   <span class="mf">3.0</span>     <span class="mf">4.0</span>       <span class="mf">9.0</span>     <span class="mf">10.0</span>
<span class="n">d</span>   <span class="n">NaN</span>     <span class="n">NaN</span>      <span class="mf">11.0</span>     <span class="mf">12.0</span>
<span class="n">e</span>   <span class="mf">5.0</span>     <span class="mf">6.0</span>      <span class="mf">13.0</span>     <span class="mf">14.0</span>
</pre></div>
</div>
<p>Phần nào vì lý do kế thừa (tức là các phiên bản pandas cũ hơn nhiều), phương thức join của DataFrame thực hiện một ghép nối trái trên các khóa nối, giữ nguyên chỉ mục hàng của DataFrame bên trái. Nó cũng hỗ trợ ghép nối chỉ mục của DataFrame được truyền vào trên một trong các cột của DataFrame gọi:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right1</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">key</span>  <span class="n">value</span>  <span class="n">group_val</span>
<span class="mi">0</span>   <span class="n">a</span>      <span class="mi">0</span>        <span class="mf">3.5</span>
<span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>        <span class="mf">7.0</span>
<span class="mi">2</span>   <span class="n">a</span>      <span class="mi">2</span>        <span class="mf">3.5</span>
<span class="mi">3</span>   <span class="n">a</span>      <span class="mi">3</span>        <span class="mf">3.5</span>
<span class="mi">4</span>   <span class="n">b</span>      <span class="mi">4</span>        <span class="mf">7.0</span>
<span class="mi">5</span>   <span class="n">c</span>      <span class="mi">5</span>        <span class="n">NaN</span>
</pre></div>
</div>
<p>Cuối cùng, đối với các ghép nối chỉ mục-đến-chỉ mục đơn giản, bạn có thể truyền một danh sách các DataFrame để ghép nối như một thay thế cho việc sử dụng hàm concat tổng quát hơn được mô tả trong phần tiếp theo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">another</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.</span><span class="p">,</span> <span class="mf">17.</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">])</span>
<span class="n">left2</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">right2</span><span class="p">,</span> <span class="n">another</span><span class="p">])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">Ohio</span>  <span class="n">Nevada</span>  <span class="n">Missouri</span>  <span class="n">Alabama</span>  <span class="n">New</span> <span class="n">York</span>  <span class="n">Oregon</span>
<span class="n">a</span>   <span class="mf">1.0</span>     <span class="mf">2.0</span>       <span class="n">NaN</span>      <span class="n">NaN</span>       <span class="mf">7.0</span>     <span class="mf">8.0</span>
<span class="n">c</span>   <span class="mf">3.0</span>     <span class="mf">4.0</span>       <span class="mf">9.0</span>     <span class="mf">10.0</span>       <span class="mf">9.0</span>    <span class="mf">10.0</span>
<span class="n">e</span>   <span class="mf">5.0</span>     <span class="mf">6.0</span>      <span class="mf">13.0</span>     <span class="mf">14.0</span>      <span class="mf">11.0</span>    <span class="mf">12.0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left2</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">right2</span><span class="p">,</span> <span class="n">another</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">Ohio</span>  <span class="n">Nevada</span>  <span class="n">Missouri</span>  <span class="n">Alabama</span>  <span class="n">New</span> <span class="n">York</span>  <span class="n">Oregon</span>
<span class="n">a</span>   <span class="mf">1.0</span>     <span class="mf">2.0</span>       <span class="n">NaN</span>      <span class="n">NaN</span>       <span class="mf">7.0</span>     <span class="mf">8.0</span>
<span class="n">b</span>   <span class="n">NaN</span>     <span class="n">NaN</span>       <span class="mf">7.0</span>      <span class="mf">8.0</span>       <span class="n">NaN</span>     <span class="n">NaN</span>
<span class="n">c</span>   <span class="mf">3.0</span>     <span class="mf">4.0</span>       <span class="mf">9.0</span>     <span class="mf">10.0</span>       <span class="mf">9.0</span>    <span class="mf">10.0</span>
<span class="n">d</span>   <span class="n">NaN</span>     <span class="n">NaN</span>      <span class="mf">11.0</span>     <span class="mf">12.0</span>       <span class="n">NaN</span>     <span class="n">NaN</span>
<span class="n">e</span>   <span class="mf">5.0</span>     <span class="mf">6.0</span>      <span class="mf">13.0</span>     <span class="mf">14.0</span>      <span class="mf">11.0</span>    <span class="mf">12.0</span>
<span class="n">f</span>   <span class="n">NaN</span>     <span class="n">NaN</span>       <span class="n">NaN</span>      <span class="n">NaN</span>      <span class="mf">16.0</span>    <span class="mf">17.0</span>
</pre></div>
</div>
</section>
<section id="ghep-noi-doc-theo-mot-truc">
<h2>Ghép Nối Dọc Theo Một Trục<a class="headerlink" href="#ghep-noi-doc-theo-mot-truc" title="Link to this heading">#</a></h2>
<p>Một loại thao tác kết hợp dữ liệu khác được gọi là ghép nối, liên kết, hoặc xếp chồng. Hàm <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> của NumPy có thể làm điều này với các mảng NumPy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arr</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>Trong ngữ cảnh của các đối tượng pandas như Series và DataFrame, có các trục được gán nhãn cho phép bạn tổng quát hóa thêm việc ghép nối mảng. Đặc biệt, bạn có một số điều cần suy nghĩ thêm:</p>
<p>Nếu các đối tượng được đánh chỉ mục khác nhau trên các trục khác, liệu chúng ta nên kết hợp các phần tử khác biệt trong các trục này hay chỉ sử dụng các giá trị chung (giao)?</p>
<p>Các khối dữ liệu ghép nối có cần phải được nhận dạng trong đối tượng kết quả không?</p>
<p>Trục “ghép nối” có chứa dữ liệu cần được bảo toàn không? Trong nhiều trường hợp, các nhãn số nguyên mặc định trong DataFrame tốt nhất là bỏ qua trong quá trình ghép nối.</p>
<p>Hàm concat trong pandas cung cấp một cách nhất quán để giải quyết từng vấn đề này. Dưới đây là một số ví dụ minh họa cách nó hoạt động. Giả sử chúng ta có ba Series không có sự trùng lặp chỉ mục:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mi">0</span>
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">c</span>    <span class="mi">2</span>
<span class="n">d</span>    <span class="mi">3</span>
<span class="n">e</span>    <span class="mi">4</span>
<span class="n">f</span>    <span class="mi">5</span>
<span class="n">g</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Mặc định, concat hoạt động dọc theo axis=0, tạo ra một Series khác. Nếu bạn truyền axis=1, kết quả sẽ là một DataFrame (trục axis=1 là các cột):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="n">a</span>  <span class="mf">0.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">c</span>  <span class="n">NaN</span>  <span class="mf">2.0</span>  <span class="n">NaN</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="mf">3.0</span>  <span class="n">NaN</span>
<span class="n">e</span>  <span class="n">NaN</span>  <span class="mf">4.0</span>  <span class="n">NaN</span>
<span class="n">f</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">5.0</span>
<span class="n">g</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">6.0</span>
</pre></div>
</div>
<p>Trong trường hợp này, không có sự trùng lặp trên trục khác, như bạn có thể thấy là hợp sắp xếp (ghép nối ‘outer’) của các chỉ mục. Bạn có thể thay vào đó giao nhau bằng cách truyền join=’inner’:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s3</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>     <span class="mi">0</span>  <span class="mi">1</span>
<span class="n">a</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">b</span>  <span class="mi">1</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>Bạn cũng có thể chỉ định các trục được sử dụng trên các trục khác với join_axes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join_axes</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>     <span class="mi">0</span>    <span class="mi">1</span>
<span class="n">a</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">c</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>
<span class="n">e</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
</pre></div>
</div>
<p>Một vấn đề tiềm năng là các phần ghép nối không được nhận dạng trong kết quả. Giả sử bạn muốn tạo một chỉ mục phân cấp trên trục ghép nối. Để làm điều này, sử dụng đối số keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">result</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">a</span>    <span class="n">b</span>    <span class="n">f</span>    <span class="n">g</span>
<span class="n">one</span>   <span class="mf">0.0</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">two</span>   <span class="mf">0.0</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">three</span> <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">5.0</span>  <span class="mf">6.0</span>
</pre></div>
</div>
<p>Trong trường hợp kết hợp các Series dọc theo axis=1, các keys trở thành các tiêu đề cột của DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>
<span class="n">a</span>  <span class="mf">0.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">c</span>  <span class="n">NaN</span>  <span class="mf">2.0</span>  <span class="n">NaN</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="mf">3.0</span>  <span class="n">NaN</span>
<span class="n">e</span>  <span class="n">NaN</span>  <span class="mf">4.0</span>  <span class="n">NaN</span>
<span class="n">f</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">5.0</span>
<span class="n">g</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="mf">6.0</span>
</pre></div>
</div>
<p>Logic tương tự cũng áp dụng cho các đối tượng DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;level1&#39;</span><span class="p">,</span> <span class="s1">&#39;level2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>      <span class="n">level1</span>      <span class="n">level2</span>
       <span class="n">one</span> <span class="n">two</span> <span class="n">three</span> <span class="n">four</span>
<span class="n">a</span>     <span class="mi">0</span>   <span class="mi">1</span>   <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>     <span class="mi">2</span>   <span class="mi">3</span>   <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>     <span class="mi">4</span>   <span class="mi">5</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Nếu bạn truyền một dict các đối tượng thay vì một danh sách, các khóa của dict sẽ được sử dụng cho tùy chọn keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">({</span><span class="s1">&#39;level1&#39;</span><span class="p">:</span> <span class="n">df1</span><span class="p">,</span> <span class="s1">&#39;level2&#39;</span><span class="p">:</span> <span class="n">df2</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>      <span class="n">level1</span>      <span class="n">level2</span>
       <span class="n">one</span> <span class="n">two</span> <span class="n">three</span> <span class="n">four</span>
<span class="n">a</span>     <span class="mi">0</span>   <span class="mi">1</span>   <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>     <span class="mi">2</span>   <span class="mi">3</span>   <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>     <span class="mi">4</span>   <span class="mi">5</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Có các đối số bổ sung điều chỉnh cách tạo chỉ mục phân cấp. Ví dụ, chúng ta có thể đặt tên cho các mức trục được tạo bằng đối số names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;level1&#39;</span><span class="p">,</span> <span class="s1">&#39;level2&#39;</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upper</span>  <span class="n">level1</span>       <span class="n">level2</span>
<span class="n">lower</span>   <span class="n">one</span> <span class="n">two</span> <span class="n">three</span> <span class="n">four</span>
<span class="n">a</span>     <span class="mi">0</span>   <span class="mi">1</span>   <span class="mf">5.0</span>   <span class="mf">6.0</span>
<span class="n">b</span>     <span class="mi">2</span>   <span class="mi">3</span>   <span class="n">NaN</span>   <span class="n">NaN</span>
<span class="n">c</span>     <span class="mi">4</span>   <span class="mi">5</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
</pre></div>
</div>
<p>Cuối cùng, đối với các DataFrame mà chỉ mục hàng không chứa bất kỳ dữ liệu liên quan nào:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>          <span class="n">a</span>        <span class="n">b</span>         <span class="n">c</span>         <span class="n">d</span>
<span class="mi">0</span>  <span class="mf">1.246435</span>  <span class="mf">1.007189</span> <span class="o">-</span><span class="mf">1.296221</span>  <span class="mf">0.274992</span>
<span class="mi">1</span>  <span class="mf">0.228913</span>  <span class="mf">1.352917</span>  <span class="mf">0.886429</span> <span class="o">-</span><span class="mf">2.001637</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.371843</span>  <span class="mf">1.669025</span> <span class="o">-</span><span class="mf">0.438570</span> <span class="o">-</span><span class="mf">0.539741</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">1.021228</span>  <span class="mf">0.476985</span>       <span class="n">NaN</span>  <span class="mf">3.248944</span>
<span class="mi">4</span>  <span class="mf">0.302614</span> <span class="o">-</span><span class="mf">0.577087</span>       <span class="n">NaN</span>  <span class="mf">0.124121</span>
</pre></div>
</div>
</section>
<section id="bang-6-3-cac-tham-so-ham-concat">
<h2>Bảng 6-3. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">concat</span></code><a class="headerlink" href="#bang-6-3-cac-tham-so-ham-concat" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tham số</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">objs</span></code></p></td>
<td><p>Danh sách hoặc dict các đối tượng pandas để ghép nối; đây là tham số bắt buộc duy nhất.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p></td>
<td><p>Trục để ghép nối dọc theo; mặc định là 0 (dọc theo các hàng).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">join</span></code></p></td>
<td><p>‘inner’ hoặc ‘outer’ (‘outer’ theo mặc định); có ghép nối giao (inner) hoặc hợp (outer) các chỉ mục dọc theo các trục khác.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">join_axes</span></code></p></td>
<td><p>Các chỉ mục cụ thể để sử dụng cho các trục khác thay vì thực hiện logic giao/hợp.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">keys</span></code></p></td>
<td><p>Các giá trị liên kết với các đối tượng đang được ghép nối, tạo thành một chỉ mục phân cấp dọc theo trục ghép nối; có thể là một danh sách hoặc mảng các giá trị bất kỳ, một mảng các tuple, hoặc một danh sách các mảng (nếu nhiều mức mảng được truyền vào).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">levels</span></code></p></td>
<td><p>Các chỉ mục cụ thể để sử dụng làm mức chỉ mục phân cấp nếu <code class="docutils literal notranslate"><span class="pre">keys</span></code> được truyền vào.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">names</span></code></p></td>
<td><p>Tên cho các mức phân cấp được tạo ra nếu <code class="docutils literal notranslate"><span class="pre">keys</span></code> và/hoặc <code class="docutils literal notranslate"><span class="pre">levels</span></code> được truyền vào.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">verify_integrity</span></code></p></td>
<td><p>Kiểm tra trục mới trong đối tượng ghép nối để phát hiện các trùng lặp và ném ra ngoại lệ nếu có; theo mặc định (False) cho phép trùng lặp.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span></code></p></td>
<td><p>Không bảo toàn các chỉ mục dọc theo trục ghép nối, thay vào đó tạo ra một chỉ mục <code class="docutils literal notranslate"><span class="pre">range(total_length)</span></code> mới.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ket-hop-du-lieu-voi-su-chong-lan">
<h2>Kết Hợp Dữ Liệu Với Sự Chồng Lấn<a class="headerlink" href="#ket-hop-du-lieu-voi-su-chong-lan" title="Link to this heading">#</a></h2>
<p>Có một tình huống kết hợp dữ liệu khác không thể biểu diễn dưới dạng một thao tác ghép nối hoặc ghép nối liên kết. Bạn có thể có hai tập dữ liệu mà chỉ mục của chúng chồng lấn một phần hoặc toàn bộ. Ví dụ điển hình là hàm <code class="docutils literal notranslate"><span class="pre">where</span></code> của NumPy, thực hiện tương đương với một biểu thức <code class="docutils literal notranslate"><span class="pre">if-else</span></code> theo mảng:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.</span> <span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">])</span>
</pre></div>
</div>
<p>Series có một phương thức combine_first, thực hiện tương đương với thao tác này cùng với logic căn chỉnh dữ liệu thông thường của pandas:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="n">NaN</span>
<span class="n">b</span>    <span class="mf">4.5</span>
<span class="n">c</span>    <span class="mf">3.0</span>
<span class="n">d</span>    <span class="mf">2.0</span>
<span class="n">e</span>    <span class="mf">1.0</span>
<span class="n">f</span>    <span class="mf">0.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Với DataFrame, combine_first làm điều tương tự từng cột một, vì vậy bạn có thể nghĩ nó như là “vá” dữ liệu thiếu trong đối tượng gọi bằng dữ liệu từ đối tượng bạn truyền vào:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">6.</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]})</span>
<span class="n">df1</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
<p>Kết quả:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>     <span class="n">a</span>    <span class="n">b</span>     <span class="n">c</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>   <span class="mf">2.0</span>
<span class="mi">1</span>  <span class="mf">4.0</span>  <span class="mf">2.0</span>   <span class="mf">6.0</span>
<span class="mi">2</span>  <span class="mf">5.0</span>  <span class="mf">4.0</span>  <span class="mf">10.0</span>
<span class="mi">3</span>  <span class="mf">3.0</span>  <span class="mf">6.0</span>  <span class="mf">14.0</span>
<span class="mi">4</span>  <span class="mf">7.0</span>  <span class="mf">8.0</span>   <span class="n">NaN</span> 
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Indexing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Đánh Chỉ Mục Phân Cấp</p>
      </div>
    </a>
    <a class="right-next"
       href="Reshaping.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Định Hình Lại và Pivoting</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-dataframe-theo-kieu-co-so-du-lieu">Ghép Nối DataFrame Theo Kiểu Cơ Sở Dữ Liệu</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-1-cac-loai-ghep-noi-khac-nhau-voi-doi-so-how">Bảng 6-1. Các loại ghép nối khác nhau với đối số <code class="docutils literal notranslate"><span class="pre">how</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-nhieu-den-nhieu">Ghép Nối Nhiều-Đến-Nhiều</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-2-cac-tham-so-ham-merge">Bảng 6-2. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">merge</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-tren-chi-muc">Ghép Nối Trên Chỉ Mục</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ghep-noi-doc-theo-mot-truc">Ghép Nối Dọc Theo Một Trục</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bang-6-3-cac-tham-so-ham-concat">Bảng 6-3. Các tham số hàm <code class="docutils literal notranslate"><span class="pre">concat</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-hop-du-lieu-voi-su-chong-lan">Kết Hợp Dữ Liệu Với Sự Chồng Lấn</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>